<!DOCTYPE html>
<html lang='en-US'>
<head>
	<title>Budgie</title>
	<meta charset="UTF-8">
	<link rel='stylesheet' type='text/css' href='Login.css'>
	<link href='https://fonts.googleapis.com/css?family=Comfortaa' rel='stylesheet'>
	<link href='https://fonts.googleapis.com/css?family=Sintony' rel='stylesheet'>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type="text/javascript" src="Login.js"></script>
</head>
<body>
	<div class='welcome'>
		<h1>Budgie</h1>
	</div>
	<div class='form'>
		<div class = "options">
			<button class = "tablink" onclick = "openOption('login', this, '#112C5F')" id = "defaultOpen">Login</button>
			<button class = "tablink" onclick = "openOption('signup', this, '#112C5F')">Sign Up</button>
		</div>
		<div id="container">
			<div id = "login" class = "tabcontent">
	        	<h2>Welcome Back!</h2>

	        	<form action="/" method="post">

	        		<input id = 'input_email_login' type="email" placeholder = "Enter Email" name = 'user_email' required>

	        		<input id = 'input_password_login' type="password" placeholder = "Enter Password" name = "psw" required>

	        		<button id = 'login_button'>Login</button>

	        	</form>
	      	</div>

	      	<div id = "signup" class = "tabcontent">
		      	<h2>Sign Up</h2>

	          	<form action="/" method="post">

	            <input id = 'input_first_name' type="text" placeholder = "First Name" required>

	            <input id = 'input_last_name' type="text" placeholder = "Last Name" required>

	            <input id = 'input_email_signup' type="email" placeholder = "Email" required>

	            <input id = 'input_password_signup' type="password" placeholder = "Create a password" required>

	          	<button id = "signup_button">Get Started</button>

	          	</form>
	      	</div>

        </div>
	</div>
	
	<div id='snackbar'></div>

	<script>
		function openOption(optionName, elmnt, color) {
	    // Hide all elements with class="tabcontent" by default */
	    var i, tabcontent, tablinks;
	    tabcontent = document.getElementsByClassName("tabcontent");
	    for (i = 0; i < tabcontent.length; i++) {
	        tabcontent[i].style.display = "none";
	    }

	    // Remove the background color of all tablinks/buttons
	    tablinks = document.getElementsByClassName("tablink");
	    for (i = 0; i < tablinks.length; i++) {
	        tablinks[i].style.backgroundColor = "";
	        tablinks[i].style.color = "";
	    }

	    // Show the specific tab content
	    document.getElementById(optionName).style.display = "block";
	    elmnt.style.backgroundColor = color;
	    elmnt.style.color = 'white';

		}

		// Get the element with id="defaultOpen" and click on it
		document.getElementById("defaultOpen").click();

		var url_base = "https://wwwp.cs.unc.edu/Courses/comp426-f17/users/marinzam/Budgie/";

		document.getElementById("signup_button").onclick = function(){

			/* CreateUser.php */
			$.ajax(url_base + "/CreateUser.php",
				{type: "POST",
				dataType: "json",
				data: JSON.stringify({
					FirstName : $("#input_first_name").val(),
					LastName: $("#input_last_name").val(),
					UserID: $("#input_email_signup").val(),
					Password: $("#input_password_signup").val()
				}),
				success: function(response) {
					console.log(response);
					location.href = "Main.html";
					localStorage.setItem('gate', 'SignUp');
					localStorage.setItem('first_name', document.getElementById("input_first_name").value);
				},
				error: function(response) {
					console.log(response);
					var snack = document.getElementById('snackbar');
					snack.className = 'show';
					snack.innerHTML = 'Incorrect Password';
					setTimeout(function(){ snack.className = snack.className.replace("show", ""); }, 3000);
				}});
		}

		document.getElementById("login_button").onclick = function(){
			/* Login.php */
			$.ajax(url_base + "/Login.php",
	            {type: "POST",
	            dataType: "json",
	            data: JSON.stringify({
	                UserID: $("#input_email_login").val(),
	                Password: $("#input_password_login").val()
	            }),
	            success: function(response) {
	                console.log(response);
					location.href = "Main.html";
					localStorage.setItem('gate', 'Login');
	            },
	            error: function(response) {
	                console.log(response);
			var snack = document.getElementById('snackbar');
			snack.className = 'show';
			snack.innerHTML = 'Incorrect Password';
			setTimeout(function(){ snack.className = snack.className.replace("show", ""); }, 3000);
	            }});
		}

	</script>
</body>
</html>
